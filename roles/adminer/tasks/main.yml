---

- name: Pull Adminer docker image
  docker_image:
    name: adminer:4.8.1-standalone
    source: pull

- name: Run Adminer container
  docker_container:
    name: "{{ container_name }}"
    image: adminer:4.8.1-standalone
    state: started
    networks:
      - name: "{{ network_name }}"
    expose:
      - "8080"
    env:
      ADMINER_DESIGN: flat

# Copy NGINX location file to server

- name: Make sure directory exists
  ansible.builtin.file:
    path: "/var/nginx/{{ my_domain_name|replace('.','-') }}/locations"
    state: directory
    
- name: Copy conf file for server
  template:
    src: nginx-location.conf.j2
    dest: "/var/nginx/{{ my_domain_name|replace('.','-') }}/locations/{{ container_name }}.conf"
